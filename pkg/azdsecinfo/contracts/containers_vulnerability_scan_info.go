package contracts

import "time"

// ContainersVulnerabilityScanInfo represents containers vulnerability scan information
type ContainersVulnerabilityScanInfo struct {
	//GeneratedTimestamp represents the time the scan info object (this) was generated
	GeneratedTimestamp time.Time `json:"generatedTimestamp"`

	// Containers an array of containers scan summaries
	Containers []*ContainerScanSummary `json:"containers"`
}

// ContainerScanSummary represents single container vulnerability scan summary
type ContainerScanSummary struct {
	//  Name contianer name in resource spec
	Name string `json:"name"`

	// ImageDigest Container's image resolved digest
	// TODO: Add documentation on this property that this is currently resolved in admission
	// time and could defer in node pull sue to local cacheing
	ImageDigest string `json:"imageDigest"`

	// ImageName container's image name
	ImageName string `json:"imageName"`

	//ScanStatus vulnerability scan status for image
	ScanStatus string `json:"scanStatus"`

	// ScanFindings vulnerability scan findings for image
	ScanFindings []*ScanFinding `json:"scanFindings"`
}

// ScanFinding represents a single findings of image vulnerability scan
type ScanFinding struct {
	// Patchable represents whether finding is patchable
	Patchable bool `json:"patchable"`

	// Id represents finding's Id
	Id string `json:"id"`

	// Severity represent's finding's severity (e.g. "high")
	Severity string `json:"severity"`
}
