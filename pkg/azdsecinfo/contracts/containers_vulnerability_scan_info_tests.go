package contracts

import (
	"testing"
	"time"

	"github.com/stretchr/testify/suite"
)

const (
	ImageName   = "tomer.azurecr.io/core:4.6"
	ImageDigest = "sha256:4a1c4b21597c1b4415bdbecb28a3296c6b5e23ca4f9feeb599860a1dac6a0108"
)

type TestSuite struct {
	suite.Suite
	info *ContainersVulnerabilityScanInfo
}

func (suite *TestSuite) SetupTest() {
	suite.info = &ContainersVulnerabilityScanInfo{
		GeneratedTimestamp: time.Now(),
		Containers: []*ContainerScanSummary{
			{
				Name:        "ContainerName",
				ImageDigest: ImageDigest,
				ImageName:   ImageName,
				ScanStatus:  "Unscanned",
				ScanFindings: []*ScanFinding{
					{
						Patchable: true,
						Id:        "123",
						Severity:  "High",
					},
				},
			},
		},
	}
}

func TestContainerScanVulnerabilities(t *testing.T) {
	suite.Run(t, new(TestSuite))
}
