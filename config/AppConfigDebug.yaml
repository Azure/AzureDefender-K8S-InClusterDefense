# A static app's configuration file. Used for local debugging.
webhook:
  certRotatorConfiguration:
    secretName: "azure-defender-proxy-cert"
    serviceName: "azure-defender-proxy-service"
    webhookName: "azure-defender-proxy-mutating-webhook-configuration"
    caName: "azure-defender-proxy-ca"
    caOrganization: "azure-defender-proxy"
    certDir: "/certs"
    namespace: "kube-system"
  managerConfiguration:
    port: 8000
    certDir: "/certs"
  serverConfiguration:
    path: "/mutate"
    enableCertRotation: true
  handlerConfiguration:
    dryRun: false
instrumentation:
  trace:
    tracerConfiguration:
      tracerLevel: 0
  tivan:
    tivanInstrumentationConfiguration:
      componentName: "debug-in-cluster-defense"
      azureResourceID: ""
      region: ""
      clusterDistribution: ""
      chartVersion: ""
      imageName: "local-development"
      imageVersion: "no-version"
      releaseTrain: ""
      nodeName: ""
      dirPath: "/var/log/azuredefender"
      mdmAccount: ""
      mdmNamespace: ""
      platformMdmAccount: ""
      platformMdmNamespace: ""

azdIdentity:
  envAzureAuthorizerConfiguration:
    mSIClientId: "" # This should be kept empty while you are running the service locally.

kubeletIdentity:
  envAzureAuthorizerConfiguration:
    mSIClientId: "" # This should be kept empty while you are running the service locally.

acr:
  craneWrappersConfiguration:
    retryPolicyConfiguration:
      retryAttempts: 3
      retryDuration: "10ms"

  tokenExchanger:
    retryPolicyConfiguration:
      retryAttempts: 3
      retryDuration: "10ms"

arg:
  argClientConfiguration:
    subscriptions: []
  argBaseClient:
    retryPolicyConfiguration:
      retryAttempts: 3
      retryDuration: "10ms"

# Cache configuration
cache:
  nonInMem:
    deploymentConfiguration:
      app: redis
      image: redis:6
      replicas: 1
    client:
      clientConfiguration:
        address: "localhost:6379"
        tables:
          serverConnectionTestTable: 0
          argDataProviderCacheTable: 1
          tag2digestCacheTable: 2
      retryPolicyConfiguration:
        retryAttempts: 3
        retryDuration: "10ms"
      serverConnectionTestRetryPolicyConfiguration:
        retryAttempts: 3
        retryDuration: "20s"
  inMem:
    tokensCacheConfiguration:
      cacheSize: 104857600

deployment:
  isLocalDevelopment:  true
  namespace: "kube-system"

azdSecInfoProvider:
  GetContainersVulnerabilityScanInfoTimeoutDuration:
    timeDuration: "10000ms"
